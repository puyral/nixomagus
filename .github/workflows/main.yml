name: Nix Build

on:
  push:
    branches:
      - master 
  pull_request:
    branches:
      - master 

jobs:
  check:
    uses: ./.github/workflows/check.yml

  dynas:
    needs: check  # Ensure this job runs after the check job
    uses: ./.github/workflows/build.yml
    with:
      hostname: dynas

  amdra:
    needs: check  # Ensure this job runs after the check job
    uses: ./.github/workflows/build.yml
    with:
      hostname: amdra

  ovh-pl:
    needs: check  # Ensure this job runs after the check job
    uses: ./.github/workflows/build.yml
    with:
      hostname: ovh-pl

  nixomagus:
    needs: check  # Ensure this job runs after the check job
    uses: ./.github/workflows/build.yml
    with:
      hostname: nixomagus

  i7:
    needs: check  # Ensure this job runs after the check job
    uses: ./.github/workflows/build.yml
    with:
      hostname: i7